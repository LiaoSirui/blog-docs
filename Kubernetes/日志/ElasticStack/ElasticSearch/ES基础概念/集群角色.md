一个 ES 节点就是一个运行的 ES 实例，可以实现数据存储并且搜索的功能。

每个节点都有一个唯一的名称作为身份标识，如果没有设置名称，默认使用 UUID 作为名称。

> 最好给每个节点都定义上有意义的名称，在集群中区分出各个节点。

一个机器可以有多个实例，所以并不能说一台机器就是一个 node，大多数情况下每个 node 运行在一个独立的环境或虚拟机上。

### 节点类型

- master 节点

集群中的一个节点会被选为 master 节点，它将负责管理集群范畴的变更，例如创建或删除索引，添加节点到集群或从集群中删除节点。

master 节点无需参与文档层面的变更和搜索，这意味着仅有一个 master 节点并不会因流量增长而成为瓶颈。

任意一个节点都可以成为 master 节点。

- data 节点

持有数据和倒排索引。

默认情况下，每个节点都可以通过设定配置文件 elasticsearch.yml 中的 node.data 属性为 true (默认) 成为数据节点。

如果需要一个专门的主节点 (一个节点既可以是 master 节点，同时也可以是 data 节点)，应将其 node.data 属性设置为 false。

- client 节点

如果将 node.master 属性和 node.data 属性都设置为 false，那么该节点就是一个客户端节点，扮演一个负载均衡的角色，将到来的请求路由到集群中的各个节点。

### 集群

节点通过设置集群名称，在同一网络中发现具有相同集群名称的节点，组成集群。

每个集群都有一个 cluster name 作为标识，默认的集群名称为 elasticsearch。

如果在同一网络中只有一个节点，则这个节点成为一个单节点集群。

### 集群状态

- Green

所有主分片和从分片都准备就绪（分配成功），即使有一台机器挂了（假设一台机器一个实例），数据都不会丢失，但会变成 Yellow 状态。

- Yellow

所有主分片准备就绪，但存在至少一个主分片（假设是 A）对应的从分片没有就绪，此时集群属于警告状态，意味着集群高可用和容灾能力下降，如果刚好 A 所在的机器挂了，而从分片还处于未就绪状态，那么 A 的数据就会丢失（查询结果不完整），此时集群进入 Red 状态。

- Red

至少有一个主分片没有就绪（直接原因是找不到对应的从分片成为新的主分片），此时查询的结果会出现数据丢失（不完整）。

## 参考资料

- <https://www.cnblogs.com/davis12/p/15500158.html>
