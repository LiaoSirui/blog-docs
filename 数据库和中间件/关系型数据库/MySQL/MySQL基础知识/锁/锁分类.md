锁分类

- 从对数据操作的粒度分 ：
  - 1）表锁：操作时，会锁定整个表。
  - 2）行锁：操作时，会锁定当前操作行。

- 从对数据操作的类型分：
  - 1）读锁（共享锁）：针对同一份数据，多个读操作可以同时进行而不会互相影响。
  - 2）写锁（排它锁）：当前操作没有完成之前，它会阻断其他写锁和读锁。

存储引擎对锁的支持

| **存储引擎** | **表级锁** | **行级锁** | **页面锁** |
| ------------ | ---------- | ---------- | ---------- |
| MyISAM       | 支持       | 不支持     | 不支持     |
| InnoDB       | 支持       | 支持       | 不支持     |
| MEMORY       | 支持       | 不支持     | 不支持     |
| BDB          | 支持       | 不支持     | 支持       |



1. 如果有索引的话，数据库删除、修改会走索引。也就是说如果 where 后的约束能够命中索引，那么删改会走索引。
2. update 时，where 中的过滤条件列，如果用索引，锁行，无法用索引，锁表。按照索引规则，如果能使用索引，锁行，不能使用索引，锁表。
3. insert，delete时，锁行。



InnoDB 行锁是通过给索引上的索引项加锁来实现的，只有通过索引条件检索数据，InnoDB 才使用行级锁，否则，InnoDB 将使用表锁。

- 注意点一：如果两个 update 语句同时执行，第一个先执行触发行锁，但是第二个没有索引触发表锁，因为有个行锁住了，所以还是会等待行锁释放，才能锁表。
- 注意点二：在高并发情况下，如果等待时间过长，会出现超时报错