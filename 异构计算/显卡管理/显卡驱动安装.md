## 手动安装

- 安装

进入英伟达驱动下载官网

<https://www.nvidia.cn/Download/index.aspx?lang=cn>

选择你需要下载的对应的版本后，点击下载即可下载一个 `.run` 的驱动安装文件

根据提示安装即可

```bash
/NVIDIA-Linux-x86_64-470.82.01.run -no-x-check -no-nouveau-check -no-opengl-files
```

安装完之后用命令测试一下

```bash
nvidia-smi
```

若显示出显卡驱动框架则安装成功

- 卸载

```bash
/usr/bin/nvidia-uninstall
```

卸载完之后

```bash
nvidia-smi
```

测试如果依然显示结果，则说明卸载失败；显示无此命令则代表卸载成功

卸载完成后需要重启服务器

## 遇到的问题

### Nouveau driver 被占用

安装驱动时，有时会提示由于 Nouveau kernel driver 在运行，所以驱动安装不成功

```plain
ERROR: The Nouveau kernel driver is currently in use by your system.  This driver is incompatible with the NVIDIA driver, and must be disabled before proceeding.  Please consult the NVIDIA driver README and your Linux
         distribution's documentation for details on how to correctly disable the Nouveau kernel driver.
```

这时需要手动禁止Nouveau kernel driver的运行。方法如下：

创建新文件：

```bash
vim /etc/modprobe.d/blacklist-nouveau.conf
```

在文件里写入：

```bash
blacklist nouveau
```

备份 initramfs

```bash
mv /boot/initramfs-$(uname -r).img /boot/initramfs-$(uname -r).img.bak
```

重建 initramfs

```bash
dracut -v /boot/initramfs-$(uname -r).img $(uname -r)
```

设置系统启动模式

```bash
> systemctl get-default

multi-user.target

# 如果是 graphical.target
# 需要执行：systemctl set-default multi-user.target
```

重启后查看

```bash
lsmod | grep nouveau
```

