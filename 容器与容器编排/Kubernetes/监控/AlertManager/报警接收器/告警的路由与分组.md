## 路由

假设 Prometheus 同时监控了两个组件：数据库组件与缓存组件；我们希望：数据库组件的告警能够发送给数据库小组的相关人员，缓存组件的告警能发送给缓存小组的相关人员。

基于告警信息的标签与 alertmanager 的路由机制，我们可以达到上面的效果。

比如，我们定义如下的路由树：

```yaml
apiVersion: monitoring.coreos.com/v1alpha1
kind: AlertmanagerConfig
metadata:
  name: config-example
  labels:
    alertmanagerConfig: example
spec:
  route:
    groupBy: ['job']
    groupWait: 30s
    groupInterval: 5m
    repeatInterval: 12h
    receiver: admin-receiver
    routes:
      - receiver: database-receiver
        match: 
          component: database    
      - receiver: memcache-receiver
        macth: 
          componnet: memcache
  receivers:
  - name: 'webhook'
    webhookConfigs:
    - url: 'http://example.com/'
```



## 参考文档

- <https://github.com/prometheus-operator/prometheus-operator/blob/main/Documentation/user-guides/alerting.md>

- <https://pshizhsysu.gitbook.io/prometheus/ff08-san-ff09-prometheus-gao-jing-chu-li/gao-jing-de-lu-you-yu-fen-zu>