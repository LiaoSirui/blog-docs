## 交换机命名规则

华为交换机分为 S1700、S2700、S3700、S5700、S6700、S7700 和 S9700 共七个产品系列。

根据用户规模的不同可分为家庭网络、中小型企业园区网、大型企业园区网

- S1700 系列：百兆二层交换机，适用于中小型网络接入层

- S2700 系列：百兆二层交换机，适用于中小型网络接入层

- S3700 系列：百兆三层交换机（支持千兆上行），适用于中型网络的接入层和小型网络的汇聚层

- S5700 系列：全千兆三层交换机，适用于大中型网络的汇聚层，中小型数据中心的接入层

- S6700 系列：万兆三层交换机，适用于中型网络的核心层、大中型网络的汇聚层，大中型数据中心的接入层

- S7700、S9300 和 S9700 系列：T 比特路由交换机，定位于大型网络的核心层和大型数据中心的核心层

华为交换机命名规则文档：<https://support.huawei.com/enterprise/zh/doc/EDOC1000013512/6bd51a51>

## Console

### 连接 Console

直接在终端上，输入命令 `screen /dev/cu.usbserial-xxxxxx 9600` 其中9600是波特率

如果需要跳出，就要用 `ctrl -`

需要重新连接，先找到原来的连接 `screen -ls` 然后用 `screen -r 16582`，16582 为通过前面命令查看到的连接的数字

### 重置登录密码

长按（6秒以上）PNP键，使交换机恢复出厂配置并自动重新启动

S200，S1700，S5700交换机忘记密码怎么办？如何修改或清除密码？<https://support.huawei.com/enterprise/zh/doc/EDOC1100197181>

（1）BootRom 密码

V100R003C00：9300

V100R005C01：huawei

V100R006C00–V100R006C03：框式交换机为 9300，盒式为 huawei

V100R006C05：`Admin@huawei.com`

V200R001C00–V200R0012C00及之后版本：`Admin@huawei.com`

（2）Console 口密码

对于 V200R010C00 之前版本，使用 Console 口首次登录设备时没有缺省密码，首次登录时的界面会提示用户配置 Console 口登录密码

对于 V200R010C00-V200R019 版本，使用 Console 口登录设备的缺省用户名为`admin`，缺省密码为`admin@huawei.com`

对于 V200R020 版本，使用 Console 口首次登录设备时没有缺省密码，首次登录时的界面会提示用户配置 Console 口登录密码

（3）重置管理密码

<https://blog.csdn.net/weixin_39137153/article/details/126898949>

## 升级固件

（1）准备

查看型号命令

```bash
# 进入全局配置模式
sys

# 查看硬件和软件版本
display version

# 查看序列号
display elabel
# BarCode=21XXXXXXXXXDMGXXXXXXX
# BarCode=21980109604ELC000589
```

在华为企业官网注册账号，然后填入你的序列号可以获得相应产品的下载权限


以 S5735-S24T4X-I 为例，对应固件下载地址为：<https://support.huawei.com/enterprise/zh/switches/cloudengine-s5735-s24t4x-pid-250703522/software>

通过这个界面可以看到，华为的固件分为主版本/补丁/web 包

1. 主版本以 cc 结尾
2. 补丁以 pat 结尾  #升级后验证命令 display patch-information
3. web 包以 web.7z/web.zip 结尾，通过http server load S5700SI-Full-V200R005C00.002.web.zip 加载，通过 http secure-server enable 和 http server enable 开启 https 和 http 管理

另外有个 bootrom.bin 的文件，适用于突然断电模式下丢失flash后的升级，普通升级不需要关注这个文件

（2）备份

备份方式

- 串口连接：xmodem 方式传输文件

- 网口//管理口网口连接：tftp/ftp 方式

备份

```bash
# 查看列表里的 cc pat web.7z 结尾的文件
dir

# 固件
tftp 10.24.28.30 puts5735-s-v200r019c10spc500.cc
tftp 10.24.28.30 put xxx.pat
tftp 10.24.28.30 put web.7z

# license
# 备份 license 主要是备份胖 AP 的 license，默认情况下华为多数 AP 只有 4 个 AP 的授权，多了要买 license
tftp 10.24.28.30 put license.dat

# 备份原有配置
tftp 10.24.28.30 put vrpcfg.zip
```

## VRP 系统

VRP 系统（通用路由平台）是华为公司数据通信产品的通用网络操作系统平台，包括路由器、交换机、防火墙、WLAN 等众多系列产品

### 常用命令

查看命令行热键

```bash
display hotkey
```

VRP 系统提供了“不完整关键字输入”功能，例如查看当前配置：

```bash
display current-configuration 
d cu
dis cu
```

按“?”可以在线查找命令帮助文档，例如

```bash
display acl ?
```

若有多个交换机或路由器，需要给设备更改名称，方便区分不同设备，避免配置错误

```bash
sysname AR1
```

几乎所的配置命令（不包括管理类的命令）都有对应的 undo 命令格式，其中 undo 作为这些命令的关键字，即为 undo 命令行。undo 命令行一般用来恢复缺省情况、禁用某个功能或者删除某项设置

```bash
sysname abc
undo sysname
```

### 进阶命令

（1）查看和更改设备的当前时间

需要在用户视图下配置设备的当前时间

```bash
display clock
```

配置时间之前要先配置时区

```bash
clock timezone CST add 8
```

再通过以下命令更改时间

```bash
clock datetime 17:0:0 2012-1-1
```

（2）查看设备的版本信息

```bash
display version
```

（3）查看设备的路由表信息

```bash
display ip routing-table
```

（4）查看设备的配置信息

```bash
display current-configuration
```

（5）配置用户登录前和登录后提示信息

在系统视图下，配置登录前信息，配置的信息需要用 `#` 包括起来

```bash
header login information
```

配置登录后的信息

```bash
header shell information
```

## 配置登录设置

### 首次登录进行初始化

VRP 系统的首次登录必须采用本地登录方式，因为此时交换机还没配备用于远程登录的用户、IP 地址等必需配置。华为 S 系列交换机可以通过 Console 口进行首次登录，实现对新交换机的基本配置

（1）配置交换机名称和 IP 地址

这里所配置的 IP 地址可以看成是管理 IP 地址，专为日后进行 Telnet 之类的远程交换机登录使用。但这里要注意的是，在华为交换机中除了一些交换机提供的专门管理口（通常为 Ethernet0/0/0 接口）外，不能直接在物理接口上配置 IP 地址，仅可在 VLAN 接口、Loopback、Tunnel、子接口等这些逻辑接口上配置 IP 地址

管理 IP 地址通常是在管理接口，或者 VLAN 接口上配置，如果交换机没有提供管理接口，通常是在 VLAN 接口上配置，可直接在缺省的 VLAN1 接口上配置

```bash
<HUAWEI>system-view
[HUAWEI] interface Vlanif 1
[HUAWEI-Vlanif2] ip address 10.1.1.2 8
[HUAWEI-Vlanif2] ip address 11.1.1.3 255.0.0.0 sub
```

（2）选择配置的用户界面

华为 S 系列交换机的 VRP 系统支持 “Console 用户界面” 和 “VTY 用户界面” 这两大类。

- Console 用户界面

当用户通过 Console 口或者 MiniUSB 口登录交换机实现本地维护时，可以根据使用需求或对交换机安全的考虑，配置相应的 Console 用户界面属性。

Console 类型的用户界面只有一个。Console 编号：固定为 CON 0，且只有这一个编号。

- VTY 用户界面（Virtual Type Terminal，虚拟类型终端）

VTY 是一种虚拟线路端口。用户通过终端与交换机建立 Telnet 或 SSH 连接后，即建立了一条 VTY 连接（或称 VTY 虚拟线路）。
当用户通过 Telnet 或 SSH 方式登录交换机实现本地或远程维护时，可以根据用户使用需求以及对交换机安全的考虑，配置 VTY 用户界面。

VTY 类型的用户界面有多个，每个用户界面可以分配给一个用户使用。VTY 编号：第一个为 VTY 0，第二个为 VTY 1，最高编号为 VTY 14，共有 15 个。

可用 `display user-interface`（不带参数）命令查看交换机当前支持的用户界面以及它们的绝对编号

```bash
display user-interface
```

（3）选择用户界面的用户验证方式

VRP 系统中对用户的验证方式有两种：Password 验证和 AAA 验证

- Password 验证：只需要进行密码验证，不需要进行用户名验证，所以只需要配置密码，不需要配置本地用户。此为缺省认证方式
- AAA 验证：需要同时进行用户名验证和密码验证，所以需要创建本地用户，并为其配置对应的密码。这种方式更安全

配置 VTY 就是配置通过 telnet 访问，默认支持 5 个用户通过 telnet 访问，最大支持 15 个用户。用户界面优先级 VRP 系统支持对登录用户进行分级管理，与命令级别一样，用户级别也对应分为 0～15 共 16 个级别，标识越高则优先级越高。

优先级：用户所能访问命令的级别由其所使用的用户界面配置的优先级或者为用户自身配置的用户优先级别决定，但高级别用户可以访问比他低的所有级别命令。也就是在 AAA 验证方式下，用户级别不是由所使用的用户界面级别确定，而是由具体的用户账户优先级别确定，更加灵活，因为这样一来，同一用户界面下的不同用户的用户级别可能不一样。

当然，这也决定了在 AAA 验证方式下，必须为具体的用户配置具体的用户优先级

## 参考资料

VLAN 划分相关：

- <https://blog.csdn.net/qq_40610003/article/details/133342658>

- <https://blog.csdn.net/2301_76462724/article/details/139454793>
